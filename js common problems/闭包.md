<!--
 * @Description:
 * @Author: 曹俊
 * @Date: 2022-07-08 18:01:51
 * @LastEditors: 曹俊
 * @LastEditTime: 2022-09-22 21:26:21
-->

# 闭包

## 定义：闭包是指有权访问另一个函数作用域内变量的函数

### 创建闭包的最常见的方式就是在一个函数内创建另一个函数，创建的函数可以访问到当前函数的局部变量。

### 闭包两个常见的用途：

- 闭包的第一个用途是使我们在函数外部能够访问到函数内部的变量。通过使用闭包，我们可以通过在外部调用闭包函数，从而在外部访问到函数内部的变量，可以使用这种方法来创建私有变量

- 函数的另一个用途是使已经运行结束的函数上下文中的变量对象继续留在内存中，因为闭包函数保留了这个变量对象的引用，所以这个变量对象不会被回收

```js
function a() {
  var n = 0;
  function add() {
    n++;
    console.log(n);
  }
  return add;
}
var a1 = a(); //注意，函数名只是一个标识（指向函数的指针），而（）才是执行函数；
a1(); //1
a1(); //2  第二次调用n变量还在内存中
```

```js
var msg = "hello";
for (var i = 0; i < 10; i++) {
  var msg = "hello" + i * 2 + i;
}
alert(msg);
```

### 解释：在 for 循环内使用 var 声明的变量 msg 并不是局部变量，而是全局变量。在 for 循环中，每循环一次，变量 msg 的值就被覆盖一次，最终 msg 的值为表达式‘hello’ + 9 _ 2 + 9 的返回结果，根据运算符的优先级，先计算 9 _ 2，返回结果为 18，接着运算 hello + 18，返回结果为字符串类型的 hello18，最后运算 hello18 + 9，返回结果为字符串类型的 hello189，故输出结果为 hello189，B 选项正确。
```js
for (var i = 0; i < 5; i++) {
            setTimeout(() => {
                console.log(i);
            }, 100 * i);
        } //5 5 5 5 5
for (let i = 0; i < 5; i++) {
            setTimeout(() => {
                console.log(i);
            }, 100 * i);
        } //0 1 2 3 4
```
